<nz-breadcrumb class = "breadcrumbSpace">
    <nz-breadcrumb-item>
      <a>
        <i nz-icon nzType="home"></i>
      </a>
    </nz-breadcrumb-item>
    <nz-breadcrumb-item>
      <a routerLink="/inicio/bodegas/consultar">
        <i nz-icon nzType="shop" nzTheme="outline"></i>
        <span>Bodegas</span>
      </a>
    </nz-breadcrumb-item>
    
  </nz-breadcrumb>
  
  <div nz-row>
    <h2 nz-col nzSpan="8" id="titulo"> Bodegas</h2>
    <button  [routerLink]="['/inicio/bodegas/crear']" nz-col nzSpan="4" nzOffset="12" nz-button nzType="primary"> Agregar Bodega </button>
  </div>
  
  <nz-table #editRowTable  nzBordered [nzData]="listOfDisplayData" nzTableLayout="fixed">
      <thead>
        <tr class="header">
         
          <th
          [nzSortOrder]="listOfColumns[0].sortOrder"
          [nzSortFn]="listOfColumns[0].sortFn"
          [nzSortDirections]="listOfColumns[0].sortDirections"
          [nzFilterMultiple]="listOfColumns[0].filterMultiple"
          [nzFilterFn]="listOfColumns[0].filterFn"
          nzCustomFilter 
          class="header"
        >
          {{ listOfColumns[0].name }}
          <nz-filter-trigger [(nzVisible)]="visibleName" [nzActive]="searchValueName.length > 0" [nzDropdownMenu]="menuName">
            <i nz-icon nzType="search"></i>
          </nz-filter-trigger>
        </th>

          <th
            [nzSortOrder]="listOfColumns[1].sortOrder"
            [nzSortFn]="listOfColumns[1].sortFn"
            [nzSortDirections]="listOfColumns[1].sortDirections"
            [nzFilterMultiple]="listOfColumns[1].filterMultiple"
            [nzFilterFn]="listOfColumns[1].filterFn"
            nzCustomFilter 
            class="header"
          >
            {{ listOfColumns[1].name }}
            <nz-filter-trigger [(nzVisible)]="visibleDireccion" [nzActive]="searchValueDireccion.length > 0" [nzDropdownMenu]="menuDireccion">
              <i nz-icon nzType="search"></i>
            </nz-filter-trigger>
          </th>

          <th
            [nzSortOrder]="listOfColumns[2].sortOrder"
            [nzSortFn]="listOfColumns[2].sortFn"
            [nzSortDirections]="listOfColumns[2].sortDirections"
            [nzFilterMultiple]="listOfColumns[2].filterMultiple"
            [nzFilterFn]="listOfColumns[2].filterFn"
            nzCustomFilter 
            class="header"
          >
            {{ listOfColumns[2].name }}
            <nz-filter-trigger [(nzVisible)]="visibleCiudad" [nzActive]="searchValueCiudad.length > 0" [nzDropdownMenu]="menuCiudad">
              <i nz-icon nzType="search"></i>
            </nz-filter-trigger>
          </th>

          <th class="header"  nzAlign= 'center'>Editar</th>
          <th class="header"  nzAlign= 'center'>Eliminar</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of editRowTable.data">
          <td>{{ data.nombre }}</td>
          <td>{{ data.direccion }}</td>
          <td >{{ data.ciudad_name }}</td>

          <td class="iconoActionEditar" nzAlign= 'center'>
              <a [routerLink]="['/inicio/bodegas/editar']" [queryParams]= "{id: data.id}" >
                  <i nz-icon nzType="form" nzTheme="outline"></i>
              </a>
          </td>
          <td class="iconoActionEliminar"  nzAlign= 'center'>
              <a  (click)="eliminarBodega(data.id)">
                  <i  nz-icon nzType="delete" nzTheme="outline"></i>
              </a>
          </td>
        </tr>
      </tbody>
  </nz-table>
  <nz-dropdown-menu #menuName="nzDropdownMenu">
    <div class="ant-table-filter-dropdown">
      <div class="search-box">
        <input type="text" nz-input placeholder="Buscar nombre" [(ngModel)]="searchValueName" />
        <button nz-button nzSize="small" nzType="primary" (click)="searchName()" class="search-button">Buscar</button>
        <button nz-button nzSize="small" (click)="resetName()">Reiniciar</button>
      </div>
    </div>
  </nz-dropdown-menu>

  <nz-dropdown-menu #menuDireccion="nzDropdownMenu">
    <div class="ant-table-filter-dropdown">
      <div class="search-box">
        <input type="text" nz-input placeholder="Buscar dirección" [(ngModel)]="searchValueDireccion" />
        <button nz-button nzSize="small" nzType="primary" (click)="searchAddress()" class="search-button">Buscar</button>
        <button nz-button nzSize="small" (click)="resetAddress()">Reiniciar</button>
      </div>
    </div>
  </nz-dropdown-menu>

  <nz-dropdown-menu #menuCiudad="nzDropdownMenu">
    <div class="ant-table-filter-dropdown">
      <div class="search-box">
        <input type="text" nz-input placeholder="Buscar ciudad" [(ngModel)]="searchValueCiudad" />
        <button nz-button nzSize="small" nzType="primary" (click)="searchCity()" class="search-button">Buscar</button>
        <button nz-button nzSize="small" (click)="resetCity()">Reiniciar</button>
      </div>
    </div>
  </nz-dropdown-menu>
  
  <nz-modal
        [(nzVisible)]="isModalCategoryVisible"
        (nzOnCancel)="handleCancel()"
  
      >
      
  
      <h3 nz-typography  >  Crear Categoría</h3>
      <hr>
  
      <form nz-form [formGroup]="categoriaForm" (ngSubmit)="submitCategoriaForm()">
        <nz-form-item nz-row nzJustify="start">
          <nz-form-label class ="labelNombre" nz-typography nz-col nzSpan="24" id="titulo" [nzSm]="24" [nzXs]="24" nzRequired nzFor="categoriaNombre">Nombre Categoría</nz-form-label>
          <nz-form-control nzSpan="10" nz-col  [nzSm]="15" [nzXs]="15" [nzErrorTip]=nameCategoriaErrorMsg>
            <input nz-input placeholder="Categoría"  formControlName="categoriaNombre" id="categoriaNombre" />
            <ng-template #nameCategoriaErrorMsg let-control>
              <ng-container *ngIf="control.hasError('required')">¡Por favor ingrese un nombre!</ng-container>
              <ng-container *ngIf="control.hasError('maxlength')">¡El nombre es demasiado largo!</ng-container>
  
              
            </ng-template>
          </nz-form-control>
        </nz-form-item>
      </form>    
      <div *nzModalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Cancelar</button>
        <button nz-button nzType="primary" [disabled]="!categoriaForm.valid" (click)="handleOk()" [nzLoading]="isModalCategoryOkLoading">Crear</button>
      </div>
    </nz-modal>